-- Load external library for GUI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Initialize UserInputService
local UserInputService = game:GetService("UserInputService")

-- Check if the platform is mobile
local isMobile = UserInputService.TouchEnabled

-- Define the whitelist
local whitelist = {
    ["erickthesad"] = true,  -- Example username
    ["bshdgdg4"] = true,  -- Example username
    ["mymanuaintwinning"] = true,  -- Add more usernames as needed
    ["g6ana"] = true,
    ["490sl"] = true,
    ["22altLOL"] = true,
    ["naohh61"] = true
}

-- Get the local player
local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer

-- Check if the local player is whitelisted
if not whitelist[localPlayer.Name] then
    localPlayer:Kick("You are not whitelisted to use this script.")
    return
end

-- Create a customizable GUI window
local Window = Rayfield:CreateWindow({
   Name = "Legend Battlegrounds - Made by SynosLucky",
   LoadingTitle = "Rayfield Interface Suite",
   LoadingSubtitle = "by Sirius",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "LegendBattlegroundsScript",
      FileName = "Config"
   },
   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },
   KeySystem = false,
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided",
      FileName = "Key",
      SaveKey = true,
      GrabKeyFromSite = false,
      Key = {"Hello"}
   }
})

-- Track state of actions
local forceState = {
    ForcePunch = false,
    ForceBlock = false,
    ForceAwaken = false,
    ForceRightDash = false,
    ForceLeftDash = false,
    ForceForwardDash = false,
    ForceBackDash = false
}

-- Function to notify the user
local function notify(actionName, state)
    local stateText = state and "activated" or "deactivated"
    Rayfield:Notify({
        Title = actionName,
        Content = "Force " .. actionName .. " is now " .. stateText,
        Duration = 5,
        Image = 4483362458
    })
end

-- Function to toggle actions
local function toggleForceAction(actionName, callback)
    local active = forceState[actionName]
    forceState[actionName] = not active
    notify(actionName, not active)
    if not active then
        pcall(callback)
    end
end

-- Create ForcePunch tab
local ForcePunchTab = Window:CreateTab("Force Punch üí•", 4483362458)

-- Force Punch button
ForcePunchTab:CreateButton({
    Name = "Activate Force Punch",
    Callback = function()
        toggleForceAction("ForcePunch", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForcePunch do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and player.Character and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Request"] = "M1Down"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Create ForceBlock tab
local ForceBlockTab = Window:CreateTab("Force Block üõ°Ô∏è", 4483362458)

-- Force Block button
ForceBlockTab:CreateButton({
    Name = "Activate Force Block",
    Callback = function()
        toggleForceAction("ForceBlock", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            local range = 15000
            while forceState.ForceBlock do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and player.Character and localPlayer.Character and not whitelist[player.Name] then
                        local localCharacter = localPlayer.Character
                        local targetCharacter = player.Character
                        if localCharacter:FindFirstChild("HumanoidRootPart") and targetCharacter:FindFirstChild("HumanoidRootPart") then
                            local distance = (localCharacter.HumanoidRootPart.Position - targetCharacter.HumanoidRootPart.Position).Magnitude
                            if distance <= range then
                                local args = {
                                    [1] = {
                                        ["Request"] = "FDown"
                                    }
                                }
                                pcall(function()
                                    targetCharacter.Network:FireServer(unpack(args))
                                end)
                            end
                        end
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Create ForceAwaken tab
local ForceAwakenTab = Window:CreateTab("Force Awaken üåü", 4483362458)

-- Force Awaken button
ForceAwakenTab:CreateButton({
    Name = "Activate Force Awaken",
    Callback = function()
        toggleForceAction("ForceAwaken", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceAwaken do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and player.Character and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Request"] = "Awaken"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Create ForceSkills tab
local ForceSkillsTab = Window:CreateTab("Force Skills ‚öîÔ∏è", 4483362458)

-- Force Dragon Rush button
ForceSkillsTab:CreateButton({
    Name = "Activate Force Dragon Rush",
    Callback = function()
        toggleForceAction("ForceDragonRush", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceDragonRush do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Number"] = "1",
                                ["Request"] = "Skill"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Force Tiger Palm button
ForceSkillsTab:CreateButton({
    Name = "Activate Force Tiger Palm",
    Callback = function()
        toggleForceAction("ForceTigerPalm", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceTigerPalm do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Number"] = "2",
                                ["Request"] = "Skill"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Force Panther Combo button
ForceSkillsTab:CreateButton({
    Name = "Activate Force Panther Combo",
    Callback = function()
        toggleForceAction("ForcePantherCombo", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForcePantherCombo do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Number"] = "3",
                                ["Request"] = "Skill"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Force Triple Kick Counter button
ForceSkillsTab:CreateButton({
    Name = "Activate Force Triple Kick Counter",
    Callback = function()
        toggleForceAction("ForceTripleKickCounter", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceTripleKickCounter do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Number"] = "4",
                                ["Request"] = "Skill"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Create ForceDash tab
local ForceDashTab = Window:CreateTab("Force Dash üöÄ", 4483362458)

-- Force Right Dash button
ForceDashTab:CreateButton({
    Name = "Activate Force Right Dash",
    Callback = function()
        toggleForceAction("ForceRightDash", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceRightDash do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Request"] = "RightDash"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Force Left Dash button
ForceDashTab:CreateButton({
    Name = "Activate Force Left Dash",
    Callback = function()
        toggleForceAction("ForceLeftDash", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceLeftDash do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Request"] = "LeftDash"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Force Forward Dash button
ForceDashTab:CreateButton({
    Name = "Activate Force Forward Dash",
    Callback = function()
        toggleForceAction("ForceForwardDash", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceForwardDash do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Request"] = "ForwardDash"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Force Back Dash button
ForceDashTab:CreateButton({
    Name = "Activate Force Back Dash",
    Callback = function()
        toggleForceAction("ForceBackDash", function()
            local players = game:GetService("Players")
            local localPlayer = players.LocalPlayer
            while forceState.ForceBackDash do
                for _, player in ipairs(players:GetPlayers()) do
                    if player ~= localPlayer and not whitelist[player.Name] then
                        local args = {
                            [1] = {
                                ["Request"] = "BackDash"
                            }
                        }
                        pcall(function()
                            player.Character.Network:FireServer(unpack(args))
                        end)
                    end
                end
                wait(0.1)
            end
        end)
    end
})

-- Create Misc tab
local MiscTab = Window:CreateTab("Miscellaneous üîß", 4483362458)

-- Infinite Jump toggle
MiscTab:CreateToggle({
    Name = "Infinite Jump",
    CurrentValue = false,
    Flag = "InfiniteJump", -- Unique flag for configuration
    Callback = function(value)
        if value then
            local userInputService = game:GetService("UserInputService")
            userInputService.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == Enum.KeyCode.Space then
                    local character = Players.LocalPlayer.Character
                    if character and character:FindFirstChild("Humanoid") then
                        character.Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
                        character.Humanoid:Move(Vector3.new(0, 10, 0))
                    end
                end
            end)
        end
    end
})

-- Create Label
MiscTab:CreateLabel("ok.")
